<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VPK Mart | Products</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
  <!-- Navbar -->
  <nav class="bg-white p-4 shadow flex justify-between">
    <a href="index.html" class="text-2xl font-bold text-green-700">VPK mart</a>
    <div class="space-x-4">
      <a href="index.html" class="text-gray-700 hover:text-green-700">Home</a>
      <a href="products.html" class="text-gray-700 hover:text-green-700">Products</a>
      <a href="blog.html" class="text-gray-700 hover:text-green-700">Blog</a>
      <a href="contact.html" class="text-gray-700 hover:text-green-700">Contact</a>
    </div>
  </nav>
  <!-- Product List -->
  <section class="container mx-auto p-8">
    <h1 class="text-3xl font-bold text-green-800 mb-8">Latest Products</h1>
    <div id="product-list" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
  </section>
  <script>
    // Dummy product data with reviews, quality, and ratings
    let products = [
      {
        name: "Fresh Apples",
        price: "₹120/kg",
        img: "./assets/apple.jpg",
        desc: "Crisp, sweet apples directly from local farms.",
        quality: "Premium Grade",
        ratings: [4.8, 5],
        reviews: [
          { user: "Anjali", text: "Very fresh and juicy!", stars: 5 },
          { user: "Raj", text: "Best apples in town!", stars: 5 },
        ],
      },
      // Additional products...
    ];

    function getStars(r) {
      return '★'.repeat(Math.floor(r)) + (r % 1 ? '½' : '');
    }

    function renderProducts() {
      const list = document.getElementById('product-list');
      list.innerHTML = "";
      products.forEach((prod, index) => {
        list.innerHTML += `
          <div class="bg-white rounded-lg shadow p-5">
            <img src="${prod.img}" alt="${prod.name}" class="w-full h-48 object-cover rounded mb-4">
            <h2 class="text-xl font-bold text-green-700 mb-2">${prod.name}</h2>
            <p class="text-gray-600 mb-2">${prod.desc}</p>
            <div class="mb-2 flex items-center">
              <span class="text-yellow-500 mr-2">${getStars(prod.ratings.reduce((a, b) => a + b, 0) / prod.ratings.length)}</span>
              <span class="text-gray-500 text-sm">(${(prod.ratings.reduce((a, b) => a + b, 0) / prod.ratings.length).toFixed(1)} / 5)</span>
            </div>
            <div class="mb-2"><span class="font-semibold">Quality:</span> ${prod.quality}</div>
            <div class="mb-2"><span class="font-semibold">Price:</span> <span class="text-green-800">${prod.price}</span></div>
            <div class="my-2 space-y-1">
              <span class="font-semibold">Top Review:</span>
              <div class="bg-gray-100 p-2 rounded text-gray-800 italic text-sm">
                "${prod.reviews[0].text}" &mdash; <span class="font-bold">${prod.reviews[0].user}</span>
                <span class="text-yellow-400">${'★'.repeat(prod.reviews[0].stars)}</span>
              </div>
            </div>
            <button class="bg-green-700 text-white px-3 py-1 rounded hover:bg-green-800 w-full mt-2" onclick="showReviewForm(${index})">Review</button>
            <div id="review-form-${index}" class="hidden mt-4">
              <textarea id="review-text-${index}" placeholder="Write your review..." class="w-full p-2 border rounded mb-2"></textarea>
              <label for="rating-${index}">Rating:</label>
              <select id="rating-${index}" class="border rounded p-1 mb-2">
                <option value="5">5 Stars</option>
                <option value="4">4 Stars</option>
                <option value="3">3 Stars</option>
                <option value="2">2 Stars</option>
                <option value="1">1 Star</option>
              </select>
              <button onclick="submitReview(${index})" class="bg-blue-600 text-white px-4 py-1 rounded hover:bg-blue-700">Submit</button>
            </div>
          </div>
        `;
      });
    }

    function showReviewForm(index) {
      const form = document.getElementById(`review-form-${index}`);
      form.classList.toggle("hidden");
    }

    function submitReview(index) {
      const reviewText = document.getElementById(`review-text-${index}`).value;
      const rating = parseInt(document.getElementById(`rating-${index}`).value);
      const username = "Anonymous"; // Replace this with user input mechanism if needed

      // Add Review and Update Ratings
      products[index].reviews.push({ user: username, text: reviewText, stars: rating });
      products[index].ratings.push(rating);
      renderProducts(); // Re-render the product list to show new reviews
    }

    renderProducts(); // Initial render
  </script>
  <footer class="bg-green-800 text-white text-center py-4">
    &copy; 2025 VPK mart. All rights reserved.
  </footer>
</body>
</html>
